[tox]
envlist = py311, lint, type, cov
skip_missing_interpreters = True

[testenv]
description = Run unit and validation tests
deps =
    pytest>=7.0
    pytest-cov>=4.0
commands =
    pytest tests/unit tests/validation -v --cov=src/heat_calc --cov-report=term-missing

[testenv:lint]
description = Run code style checks
skip_install = True
deps =
    black>=23.0
    isort>=5.0
    flake8>=6.0
commands =
    black --check src/ tests/
    isort --check src/ tests/
    flake8 src/ tests/

[testenv:format]
description = Format code
skip_install = True
deps =
    black>=23.0
    isort>=5.0
commands =
    black src/ tests/
    isort src/ tests/

[testenv:type]
description = Run type checking with mypy
deps =
    mypy>=1.0
    {[testenv]deps}
commands =
    mypy src/heat_calc --strict

[testenv:cov]
description = Generate coverage report
deps =
    pytest>=7.0
    pytest-cov>=4.0
commands =
    pytest tests/ --cov=src/heat_calc --cov-report=html --cov-report=term-missing

[testenv:docs]
description = Build documentation
changedir = docs
skip_install = True
deps =
    sphinx>=6.0
commands =
    sphinx-build -W -b html -d {{envtmpdir}}/doctrees . {{envtmpdir}}/html
